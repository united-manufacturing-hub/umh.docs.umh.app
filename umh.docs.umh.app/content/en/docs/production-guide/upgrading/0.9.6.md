---
title: "Upgrade to v0.9.6"
content_type: upgrading
description: "This page describes how to upgrade the United Manufacturing Hub
to version 0.9.6"
weight: -3
aliases:
   - /docs/production-guide/upgrading/upgrading-from-0.9.5-to-0.9.6/
---

This page describes how to upgrade the United Manufacturing Hub to version
0.9.6. Before upgrading, remember to backup the
[database](/docs/production-guide/backup_recovery/backup-timescale/),
[Node-RED flows](/docs/production-guide/backup_recovery/import-export-node-red/),
and your cluster configuration.

## Add Helm repo in {{% resource type="lens" name="name" %}}

Check if the UMH Helm repository is added in {{% resource type="lens" name="name" %}}.
To do so, from the top-left menu, select **FIle** > **Preferences** (or press `CTRL + ,`).
Click on the **Kubernetes** tab and check if the **Helm Chart** section contains
the `https://repo.umh.app` repository.

If it doesn't, click the **Add Custom Helm Repo** button and fill in the following
values:

- Helm repo name: {{% resource type="helm" name="repo" %}}
- URL: {{% resource type="helm" name="repo-url" %}}

Then click **Add**.

<!-- Add here any steps needed before deleting the deployments and statefulsets -->

## Add new index to the database

In this version, a new index has been added to the `processValueTabe` table,
allowing to speed up the queries.

### Open a shell in the database

{{< include "open-database-shell" >}}

### Create the index

Execute the following query:

```sql
CREATE INDEX ON processvaluetable(valuename, asset_id) WITH (timescaledb.transaction_per_chunk);
REINDEX TABLE processvaluetable;
```

This command could take a while to complete, especially on larger tables.

Type `exit` to close the shell.

## Clear Workloads

Some workloads need to be deleted before upgrading. This process _does not_ delete
any data, but it will cause downtime. If a workload is missing, it means that it
was not enabled in your cluster, therefore you can skip it.

To delete a resource, you can select it using the box on the left of the
resource name and click the **-** button on the bottom right corner.

1. Open the **Workloads** tab.
2. From the **Deployment** section, delete the following deployments:
   - {{% resource type="deployment" name="barcodereader" %}}
   - {{% resource type="deployment" name="factoryinsight" %}}
   - {{% resource type="deployment" name="kafkatopostgresql" %}}
   - {{% resource type="deployment" name="mqttkafkabridge" %}}
   - {{% resource type="deployment" name="mqttsimulator" %}}
   - {{% resource type="deployment" name="opcuasimulator" %}}
3. From the **StatefulSet** section, delete the following statefulsets:
   - {{% resource type="statefulset" name="mqttbridge" %}}
   - {{% resource type="statefulset" name="mqttbroker" %}}
   - {{% resource type="statefulset" name="nodered" %}}
   - {{% resource type="statefulset" name="sensorconnect" %}}

<!-- Add here any steps needed before upgrading the Helm Chart -->

## Upgrade Helm Chart

Now everything is ready to upgrade the Helm chart.

1. Navigate to the **Helm** > **Releases** tab.
2. Select the {{% resource type="helm" name="release" %}} release and click
   **Upgrade**.
3. In the **Helm Upgrade** window, make sure that the `Upgrade version` field
   contains the version you want to upgrade to.
4. You can also change the values of the Helm chart, if needed.
   <!-- Add here any changes needed to the values.yaml -->
5. Click **Upgrade**.

The upgrade process can take a few minutes. The upgrade is complete when the
**Status** field of the release is Deployed.

<!-- Add here any steps needed after upgrading the Helm Chart -->