---
title: "Upgrade to v0.9.15"
content_type: upgrading
description: "This page describes how to upgrade the United Manufacturing Hub
to version 0.9.15"
weight: -15
---

This page describes how to upgrade the United Manufacturing Hub to version
0.9.15. Before upgrading, remember to backup the
[database](/docs/production-guide/backup_recovery/backup-timescale/),
[Node-RED flows](/docs/production-guide/backup_recovery/import-export-node-red/),
and your cluster configuration.

## Add Helm repo in {{% resource type="lens" name="name" %}}

Check if the UMH Helm repository is added in {{% resource type="lens" name="name" %}}.
To do so, from the top-left menu, select **FIle** > **Preferences** (or press `CTRL + ,`).
Click on the **Kubernetes** tab and check if the **Helm Chart** section contains
the `https://repo.umh.app` repository.

If it doesn't, click the **Add Custom Helm Repo** button and fill in the following
values:

- Helm repo name: {{% resource type="helm" name="repo" %}}
- URL: {{% resource type="helm" name="repo-url" %}}

Then click **Add**.

<!-- Add here any steps needed before deleting the deployments and statefulsets -->

## Clear Workloads

Some workloads need to be deleted before upgrading. This process _does not_ delete
any data, but it will cause downtime. If a workload is missing, it means that it
was not enabled in your cluster, therefore you can skip it.

To delete a resource, you can select it using the box on the left of the
resource name and click the **-** button on the bottom right corner.

1. Open the **Workloads** tab.
2. From the **Deployment** section, delete the following deployments:
   - {{% resource type="deployment" name="factoryinsight" %}}
   - {{% resource type="deployment" name="opcuasimulator" %}}
   - {{% resource type="deployment" name="mqttsimulator" %}}
   - {{% resource type="deployment" name="grafanaproxy" %}}
3. From the **StatefulSet** section, delete the following statefulsets:
   - {{% resource type="statefulset" name="mqttbroker" %}}
   - {{% resource type="statefulset" name="kafkabroker" %}}
   - {{% resource type="statefulset" name="nodered" %}}
   - {{% resource type="statefulset" name="sensorconnect" %}}
   - {{% resource type="statefulset" name="mqttbridge" %}}
4. Open the **Network** tab.
5. From the **Services** section, delete the following services:
   - {{% resource type="service" name="kafkabroker" %}}

<!-- Add here any steps needed before upgrading the Helm Chart -->

## Upgrade Helm Chart

Now everything is ready to upgrade the Helm chart.

1. Navigate to the **Helm** > **Releases** tab.
2. Select the {{% resource type="helm" name="release" %}} release and click
   **Upgrade**.
3. In the **Helm Upgrade** window, make sure that the `Upgrade version` field
   contains the version you want to upgrade to.
4. You can also change the values of the Helm chart, if needed.
   If you want to activate the new databridge you need to add & edit the following section

   ```yaml
   _000_commonConfig:      
      ...
      datamodel_v2:
      enabled: true
      bridges:
      - mode: mqtt-kafka
        brokerA: united-manufacturing-hub-mqtt:1883 # The flow is always from A->B, for omni-directional flow, setup a 2nd bridge with reversed broker setup
        brokerB: united-manufacturing-hub-kafka:9092
        topic: umh.v1..*              # accept mqtt or kafka topic format. after the topic seprator, you can use # for mqtt wildcard, or .* for kafka wildcard
        topicMergePoint: 5            # This is a new feature of our datamodel_old, which splits topics in topic and key (only in Kafka), preventing having lots of topics
        partitions: 6                 # optional: number of partitions for the new kafka topic. default: 6
        replicationFactor: 1          # optional: replication factor for the new kafka topic. default: 1
      ...
   ```

   You can also enable the new container registry by changing the values in the
   `image` or `image.repository` fields from unitedmanufacturinghub/\<image-name>
   to ghcr.io/united-manufacturing-hub/\<image-name>.

5. Click **Upgrade**.

The upgrade process can take a few minutes. The upgrade is complete when the
**Status** field of the release is Deployed.

<!-- Add here any steps needed after upgrading the Helm Chart -->